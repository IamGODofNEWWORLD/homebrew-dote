#include <stdio.h>
#include <unistd.h>
#include <stdlib.h>
#include <signal.h>

char a[16][16] = {
{3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3},
{3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3},
{3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3},
{3,3,3,3,1,1,1,1,1,1,1,1,1,3,3,3},
{3,3,3,1,15,15,15,15,15,15,15,15,15,1,3,3},
{17,1,17,1,15,13,13,14,1,13,13,14,15,1,1,3},
{1,16,1,1,15,14,13,13,1,1,13,13,15,1,1,3},
{1,16,16,1,15,13,13,13,1,16,1,1,1,16,1,3},
{18,1,16,1,15,13,13,14,1,16,16,16,16,16,1,3},
{19,19,1,1,15,14,13,13,1,16,1,16,1,16,1,3},
{20,20,20,1,15,15,15,15,1,11,16,16,16,11,1,3},
{3,3,1,1,1,1,1,1,1,1,1,1,1,1,3,3},
{3,1,16,1,16,1,3,3,1,16,1,16,1,3,3,3},
{3,1,1,3,1,3,3,3,3,1,3,1,1,3,3,3},
{3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3},
{3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3},
};

char b[16][16] = {
{3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3},
{3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3},
{3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3},
{3,3,3,3,1,1,1,1,1,1,1,1,1,3,3,3},
{3,3,3,1,15,15,15,15,1,15,15,15,15,1,1,3},
{17,17,1,1,15,13,13,14,1,1,13,14,15,1,1,3},
{21,1,16,1,15,14,13,13,1,16,1,1,1,16,1,3},
{1,16,16,1,15,13,13,13,1,16,16,16,16,16,1,3},
{1,16,1,1,15,13,13,14,1,16,1,16,1,16,1,3},
{1,1,19,1,15,14,13,13,1,11,16,16,16,11,1,3},
{20,20,20,1,15,15,15,15,15,1,1,1,1,1,3,3},
{3,3,3,1,1,1,1,1,1,1,1,1,1,3,1,3},
{3,3,3,1,16,1,16,1,3,3,1,16,1,16,1,3},
{3,3,3,1,1,3,1,3,3,3,3,1,3,1,1,3},
{3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3},
{3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3}
};

int color(int code){
  switch(code){
    case 1:  return 16;  // 黒
    case 3:  return 19;  // 青（背景）
    case 11: return 206; // ピンク
    case 13: return 206; // ピンク
    case 14: return 201; // 濃いピンク
    case 15: return 229; // 薄いクリーム
    case 16: return 240; // グレー
    case 17: return 160; // 赤
    case 18: return 46;  // 緑
    case 19: return 27;  // 水色
    case 20: return 129; // 紫
    case 21: return 208;
    default: return 0;   // 未定義 → 黒
  }
}


void animation(int x, int is_rev){
  printf("\e[H\e[J\e[?7l");
  if(x % 2 == 0){
    for(int i = 0; i < 16; i++){
      printf("%*s", x, "");
      for(int j = 0; j < 16; j++){
        if(is_rev == 0) printf("\e[48;5;%dm", color(a[i][j]));
        else printf("\e[48;5;%dm", color(a[i][15 - j]));
        printf("%s", "  ");
        printf("\e[0m");
      }
      printf("\n");
    }
  }
  else{
    for(int i = 0; i < 16; i++){
      printf("%*s", x, "");
      for(int j = 0; j < 16; j++){
        if(is_rev == 0) printf("\e[48;5;%dm", color(b[i][j]));
        else printf("\e[48;5;%dm", color(b[i][15 - j]));
        printf("%s", "  ");
        printf("\e[0m");
      }
      printf("\n");
    }
  }
}

int main(){
  system("afplay Nyan_Cat.mp3 &");
  for(int x = 0; x < 60; x++){
    animation(x, 0);
    usleep(100000);
  }
  for(int x = 60; x > 0; x--){
    animation(x, 1);
    usleep(100000);
  }
  ungetc(EOF, stdin);
  return 0;
}